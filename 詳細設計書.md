# OJT課題「オセロゲーム」 詳細設計書


## 変更履歴
|日付|版|説明|作成者/変更者|
|:---|:---|:---|:---|
|2022/11/24|1.0|初版|後藤政允|



## 目次
- [はじめに](#はじめに)
  - [本書の目的](#本書の目的)
  - [本書の記述内容](#本書の記述内容)
- [詳細設計仕様](#詳細設計仕様)
  - [状態遷移図](#状態遷移図)
  - [シーケンス図](#シーケンス図)
- [関数定義](#関数定義)
  - [define定義](#define定義)
  - [グローバル変数定義](#グローバル変数定義)
  - [内部関数定義](#内部関数定義)
- [未決定事項](#未決定事項)


## はじめに
### 本書の目的
　要件をどこでどのように実現するかを明確にし、システム及びソフトウェアの方式を設計する事。
また、設計したアーキテクチャに対し、直接の利害関係者の合意を形成する事。

### 本書の記述内容
「詳細設計仕様」で、ファイルの構成と各関数の関係性を明らかにする。  
「関数定義」で、関数仕様の詳細を明らかにする。  
「未決定事項」で、未決定としていることを明確にする。  


## 詳細設計仕様
* othello.c：メイン関数を扱うファイル。
* section.c：開始前、実行中、終了時の各セクションを担う関数を扱うファイル。
* board.c：オセロ盤の情報に依存する関数を扱うファイル。
* not_board.c：オセロ盤の情報に依存しない関数を扱うファイル。

### 状態遷移図
![状態遷移図](状態遷移図.jpg)

### シーケンス図
![シーケンス図](シーケンス図.jpg)


## 関数定義
### define定義
* 真偽の定数  
FALSE　0  
TRUE　 1
* 石  
WHITE_STONE　'0'  
BLACK_STONE　'1'  
BLANK　　　　 '9'
* ファイル名  
FILE_NAME　"savedata.txt"
* セーブデータのサイズ  
SAVEDATA_SIZE　65
* 初期盤面を表すデータ  
INITIAL_PLACEMENT　"B9999999999999999999999999990199999910999999999999999999999999999"

### グローバル変数定義
* board
  |型|要素数|概要|
  |:---|:---|:---|
  |char[]|SAVEDATA_SIZE＋1|・オセロ盤を表す配列。<br>・初期値はINITIAL_PLACEMENT。<br>・board.cのみで使用する。|

### 内部関数定義
- othello.c
  - main()  
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|int|-|-|
    * 仕様説明  
      オセロゲームを実行する、メイン関数。

- section.c
  - opening_game()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|void|-|-|
    * 仕様説明  
      システム起動からゲーム開始までの処理の流れ。  
      ゲームをはじめから開始するか、つづきから開始するか決める。

  - playing_game()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|int|-|ゲーム終了時にTRUE、それ以外はFALSEを返す。|
    * 仕様説明  
      ゲーム開始から終了するまでの処理の流れ。  
      プレイヤーの入力を元に、ゲームを進行する。
    
  - closing_game()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|void|-|-|
    * 仕様説明  
      ゲーム終了からシステム終了までの処理の流れ。  
      ゲームの勝敗を決め、もう一度はじめから始めるか、終了するか決める。

- board.c
  - savedata_existence()：
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|int|-|TRUE、またはFALSE。|
    * 仕様説明  
      ファイル名がFILE_NAMEのファイルが存在するか確認する。  
      存在する場合はTRUE、ない場合はFALSEを返す。  
  
  - savedata_content()：
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|int|-|TRUE、またはFALSE。|
    * 仕様説明  
      ファイルの中身がセーブデータ仕様に沿ったものになっているか確認する。  
      なっていればTRUE、なっていなければFALSEを返す。  
  
  - investigate_stone_place()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|int*|possible_place|石を置ける場所の要素番号の配列。|
      |戻り値|int|-|TRUE、またはFALSE。|
    * 仕様説明  
      石を置ける場所があるかどうかを確認する。  
      ある場合は、置ける場所の要素番号を配列に格納し引数で渡す。戻り値はTRUEを返す。  
      ない場合はFALSEを返す。
  
  - turnover_stone()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|int|decide_place|石を置いた場所の要素番号。|
      |戻り値|void|-|-|
    * 仕様説明  
      石を置く場所の要素番号を引数から受け取り、その石ではさんだ石の要素を
      BLACK_STONEならWHITE_STONEに、WHITE_STONEならBLACK_STONEにする。
  
  - data_save()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|void|-|-|
    * 仕様説明  
      変数boardの内容を、ファイル名がFILE_NAMEのファイルへ書き込む。  
      ファイルがない場合は新規作成し、ある場合は上書きする。  
  
  - display_board()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|void|-|-|
    * 仕様説明  
      現在のオセロ盤の状態をコンソール上に表示する。
  
  - stone_num()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|char|stone_type|BLACK_STONEかWHITE_STONE|
      |戻り値|int|cnt|盤上の石の数。|
    * 仕様説明  
      黒と白どちらの石かの情報を引数から受け取り、盤上にあるそれらの石の数を戻り値で返す。

- not_board.c
  - confirm_stone_input()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|char*|input|石を置く場所の入力内容。|
      |戻り値|int|element_num|その場所の要素番号、またはFALSE。|
    * 仕様説明  
      石を置く場所の入力が仕様と一致しているか確認する。  
      入力が正しい場合はその場所の要素番号、正しくない場合はFALSEを返す。
  
  - show_winner()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数１|int|black_stone_num|盤上の黒い石の数|
      |引数２|int|white_stone_num|盤上の白い石の数|
      |戻り値|void|-|-|
    * 仕様説明  
      盤上の黒い石、白い石の数を引数で受け取り、数が多い方を勝者として表示する。  
      同数の場合は引き分けとして表示する。
  
  - remove_data()
    * 書式
      ||型|変数名|概要|
      |:---|:---|:---|:---|
      |引数|-|-|-|
      |戻り値|void|-|-|
    * 仕様説明  
      ファイル名がFILE_NAMEのファイルを削除する。

## 未決定事項
特になし。
